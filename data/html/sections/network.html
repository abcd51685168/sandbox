<section id="network">
    <div class="section-title">
        <h4>网络分析</h4>
    </div>
    {% if results.sandbox_result.network %}
        {% if results.sandbox_result.network.hosts %}
            <div>
                {% if summary_report %}
                <h4>相关主机</h4>
                <div id="hosts">
                {% else %}
                <h4><a href="javascript:showHide('hosts');">相关主机</a></h4>
                <div id="hosts" style="display: none;">
                {% endif %}
                    <table class="table table-striped table-bordered">
                    	<thead>
                        <tr>
                            <th class="tableth"  style="text-align: center; ">IP地址</th>
                            <th class="tableth"  style="text-align: center; ">主机名</th>
                        </tr>
                      </thead>
                  		<tbody>
                        {% for host in results.sandbox_result.network.hosts %}
                        <tr>
                            <td style="text-align: center; "><span>{{host.ip}}</span></td>
                            <td style="text-align: center; "><span>{{host.hostname}}</span></td>
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                </div>
            </div>
        {% endif %}

        {% if results.sandbox_result.network.domains %}
        <div>
            {% if summary_report %}
            <h4>DNS请求</h4>
            <div id="dns">
            {% else %}
            <h4><a href="javascript:showHide('dns');">DNS请求</a></h4>
            <div id="dns" style="display: none;">
            {% endif %}
                <table class="table table-striped table-bordered">
                	<thead>
                    <tr>
                        <th class="tableth"  style="text-align: center; ">域</th>
                        <th class="tableth"  style="text-align: center; ">IP地址</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for dns in results.sandbox_result.network.domains %}
                    <tr>
                        <td style="text-align: center; "><span>{{dns.domain}}</span></td>
                        <td style="text-align: center; "><span>{{dns.ip}}</span></td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
            </div>
        </div>
        {% endif %}

        {% if not summary_report %}

        {% if results.sandbox_result.network.tcp %}
            <div>
                <h4><a href="javascript:showHide('tcp');">TCP连接</a></h4>
                <div id="tcp" style="display: none;">
                    <table class="table table-striped table-bordered">
                    	<thead>
                        <tr>
                            <th class="tableth"  style="text-align: center; ">IP地址</th>
                            <th class="tableth"  style="text-align: center; ">端口</th>
                        </tr>
                      </thead>
                  		<tbody>
                        {% for conn in results.sandbox_result.network.tcp %}
                        <tr>
                            <td style="text-align: center; "><span>{{conn.dst}}</span></td>
                            <td style="text-align: center; "><span>{{conn.dport}}</span></td>
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                </div>
            </div>
        {% endif %}

        {% if results.sandbox_result.network.udp %}
            <div>
                <h4><a href="javascript:showHide('udp');">UDP连接</a></h4>
                <div id="udp" style="display: none;">
                    <table class="table table-striped table-bordered">
                    	<thead>
                        <tr>
                            <th class="tableth"  style="text-align: center; ">IP地址</th>
                            <th class="tableth"  style="text-align: center; ">端口</th>
                        </tr>
                      </thead>
                  		<tbody>
                        {% for conn in results.sandbox_result.network.udp %}
                        <tr>
                            <td style="text-align: center; "><span>{{conn.dst}}</span></td>
                            <td style="text-align: center; "><span>{{conn.dport}}</span></td>
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                </div>
            </div>
        {% endif %}

        {% if results.sandbox_result.network.http %}
        <div>
            <h4><a href="javascript:showHide('http');">HTTP请求</a></h4>
            <div id="http" style="display: none;">
                <table class="table table-striped table-bordered">
                	<thead>
                    <tr>
                        <th class="tableth"  style="text-align: center; ">URL</th>
                        <th class="tableth"  style="text-align: center; ">数据</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for http in results.sandbox_result.network.http %}
                    <tr>
                        <td style="text-align: center; "><span>{{http.uri}}</span></td>
                        <td style="text-align: center; "><span><pre>{{http.data}}</pre></span></td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
            </div>
        </div>
        {% endif %}

        {% if results.sandbox_result.network.irc %}
        <div>
            <h4><a href="javascript:showHide('irc');">IRC请求</a></h4>
            <div id="irc" style="display: none;">
                <table class="table table-striped table-bordered">
                	<thead>
                    <tr>
                        <th class="tableth"  style="text-align: center; ">命令</th>
                        <th class="tableth"  style="text-align: center; ">参数</th>
                        <th class="tableth"  style="text-align: center; ">类型</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for irc in results.sandbox_result.network.irc %}
                    <tr>
                        <td style="text-align: center; "><span>{{irc.command}}</span></td>
                        <td style="text-align: center; "><span><pre>{{irc.params}}</pre></span></td>
                        <td style="text-align: center; "><span><pre>{{irc.type}}</pre></span></td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
            </div>
        </div>
        {% endif %}

        {% if results.sandbox_result.network.icmp %}
        <div>
            <h4><a href="javascript:showHide('icmp');">ICMP请求</a></h4>
            <div id="icmp" style="display: none;">
                <table class="table table-striped table-bordered">
                	<thead>
                    <tr>
                       <th class="tableth"  style="text-align: center; ">源</th>
                       <th class="tableth"  style="text-align: center; ">目的</th>
                       <th class="tableth"  style="text-align: center; ">ICMP类型</th>
                       <th class="tableth"  style="text-align: center; ">数据</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for icmp in results.sandbox_result.network.icmp %}
                    <tr>
                       <td style="text-align: center; "><span>{{icmp.src}}</span></td>
                       <td style="text-align: center; "><span>{{icmp.dst}}</span></td>
                       <td style="text-align: center; "><span>{{icmp.type}}</span></td>
                       <td style="text-align: center; "><span><pre>{{icmp.data}}</pre></span></td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
            </div>
         </div>
        {% endif %}

        {% endif %}

        {% if not results.sandbox_result.network.hosts and not results.sandbox_result.network.domains and not results.sandbox_result.network.http and not results.sandbox_result.network.irc and not results.sandbox_result.network.icmp %}
            <div class="nothing">没有内容.</div>
        {% endif %}
    {% else %}
        <div class="nothing">没有内容.</div>
    {% endif %}
</section>
